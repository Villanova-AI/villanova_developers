(window.webpackJsonp=window.webpackJsonp||[]).push([[249],{950:function(e,a,t){"use strict";t.r(a);var o=t(36),n=Object(o.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"invoking-villanova-core-apis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#invoking-villanova-core-apis"}},[e._v("#")]),e._v(" Invoking Villanova Core APIs")]),e._v(" "),t("p",[e._v("This tutorial describes how to set up an environment ready to invoke Villanova Core APIs using Postman. Villanova uses Swagger to automatically generate OpenAPI documentation that describes the available APIs.")]),e._v(" "),t("p",[e._v("Villanova core APIs are accessible from a base URL such as localhost:8080/entando-de-app/api. For example, the page controller is available under /pages at the URL localhost:8080/entando-de-app/api/pages. The page template controller is available at localhost:8080/entando-de-app/api/pageModels.")]),e._v(" "),t("p",[e._v("To perform extensive testing with APIs on Postman, set up an environment and define a variable to host the access token saved with a POST request to /oauth/token. This should provide access to all API endpoints and actions for which the user is authorized.")]),e._v(" "),t("blockquote",[t("p",[e._v("Refer to "),t("RouterLink",{attrs:{to:"/villanova10/docs/consume/identity-management.html#authorization"}},[e._v("User Management Roles")]),e._v(" for more details.")],1)]),e._v(" "),t("h2",{attrs:{id:"prerequisites"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),t("ul",[t("li",[e._v("Basic knowledge of Postman. You can download the Postman application or use Postman on the web. The latter requires changes to the Keycloak configuration.")]),e._v(" "),t("li",[e._v("A local running copy of the Villanova App Engine. For more details, refer to the "),t("a",{attrs:{href:"https://github.com/Villanova-AI/app-engine/blob/develop/README.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("Villanova App Engine GitHub Readme"),t("OutboundLink")],1),e._v(".")]),e._v(" "),t("li",[e._v("An enabled Swagger UI")])]),e._v(" "),t("h2",{attrs:{id:"set-up-a-postman-environment"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#set-up-a-postman-environment"}},[e._v("#")]),e._v(" Set Up a Postman Environment")]),e._v(" "),t("ol",[t("li",[e._v("Create a new Postman environment and define the following variables:")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("access_token: #no value\nrefresh_token: #no value\nurl: #URL of your application (i.e. http://localhost:8080/entando-de-app)`\n")])])]),t("blockquote",[t("p",[e._v("Be careful with the URL variable and make sure you do not have a trailing slash.")])]),e._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[e._v("Set Postman to use this environment.")])]),e._v(" "),t("h2",{attrs:{id:"get-an-access-token"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#get-an-access-token"}},[e._v("#")]),e._v(" Get an Access Token")]),e._v(" "),t("ol",[t("li",[t("p",[e._v('Create a new collection. Give it an appropriate name like "Access Token."')])]),e._v(" "),t("li",[t("p",[e._v('Create a new POST request with the following parameters. Note we are calling the "URL" environment variable for convenience.')]),e._v(" "),t("ul",[t("li",[t("p",[t("code",[e._v("URL")]),e._v(' →  "/api/oauth/token"')])]),e._v(" "),t("li",[t("p",[t("code",[e._v("Auth")]),e._v(" section")]),e._v(" "),t("ol",[t("li",[t("code",[e._v("Type")]),e._v(" → Basic Auth")]),e._v(" "),t("li",[e._v("Enter "),t("code",[e._v("Username")]),e._v(" and "),t("code",[e._v("Password")]),e._v(". Valid Villanova credentials are required. They will be the same as used for the App Builder.")])])]),e._v(" "),t("li",[t("p",[t("code",[e._v("Headers")]),e._v(" section "),t("br"),e._v("\nCreate a new "),t("code",[e._v("Key")]),e._v("-"),t("code",[e._v("Value")]),e._v(" pair as shown: "),t("br"),e._v('\n"Content-Type" : "application/x-www-form-urlencoded"')])]),e._v(" "),t("li",[t("p",[t("code",[e._v("Body")]),e._v(" section")]),e._v(" "),t("ol",[t("li",[e._v('Select "x-www-form-urlencoded" from the drop-down menu')]),e._v(" "),t("li",[e._v("Create "),t("code",[e._v("Key")]),e._v("-"),t("code",[e._v("Value")]),e._v(" pairs for username and password."),t("br"),e._v(" "),t("code",[e._v("Key")]),e._v(': "username", Value: #valid Villanova username such as '),t("code",[e._v("admin")]),e._v(" "),t("br"),e._v(" "),t("code",[e._v("Key")]),e._v(': "password", Value: #password of the valid user'),t("br"),e._v("\ngrant_type: "),t("code",[e._v("password")])])])]),e._v(" "),t("li",[t("p",[t("code",[e._v("Tests")]),e._v(" section"),t("br"),e._v("\nEnter the following code so new requests can make use of the access token.")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('var data = JSON.parse(responseBody);\npostman.setEnvironmentVariable("access_token", data.access_token);\n')])])]),e._v(" "),t("details",[t("summary",[e._v("Details about the code")]),e._v('The first line of code defines a variable called "data", which hosts the JSON-parsed responseBody from the POST request sent to /oauth/token. The second line sets the environment variable "access_token" to the value returned by the POST request.')])])])]),e._v(" "),t("li",[t("p",[e._v("Send the POST request.  If successful, you should get a response like this:")]),e._v(" "),t("p",[t("code",[e._v('{ "access_token": "b96096493a40b1a7364bd54a6ffb609b", "token_type": "bearer", "refresh_token": "79ff84062b5dc13663961a833b0788f9", "expires_in": 3599 }')])])])]),e._v(" "),t("blockquote",[t("p",[e._v("Checking your Postman environment, you should see that the access_token and the refresh_token variable values have been updated.")])]),e._v(" "),t("h2",{attrs:{id:"prepare-a-generic-api-request"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prepare-a-generic-api-request"}},[e._v("#")]),e._v(" Prepare a Generic API Request")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Create a new request with the following parameters:")]),e._v(" "),t("ul",[t("li",[t("p",[t("code",[e._v("Authorization")]),e._v(" section "),t("br"),e._v(" "),t("code",[e._v("Type")]),e._v(': "Inherit auth from parent"')])]),e._v(" "),t("li",[t("p",[t("code",[e._v("Headers")]),e._v(" section "),t("br"),e._v("\nCreate the following Key-Value pairs:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("Key")]),e._v(': "Authorization", '),t("code",[e._v("Value")]),e._v(': "Bearer"')]),e._v(" "),t("li",[t("code",[e._v("Key")]),e._v(': "Content-Type", '),t("code",[e._v("Value")]),e._v(': "application/json"')])])])])]),e._v(" "),t("li",[t("p",[e._v("Select the appropriate method (GET, DELETE, POST, etc.) for your request and enter the URL with appropriate values, (i.e. localhost:8080/entando-de-app/api/pages).")])]),e._v(" "),t("li",[t("p",[e._v("Add the relevant payload in JSON format to the Body section. Remember to select raw and JSON (application/json).")])]),e._v(" "),t("li",[t("p",[e._v("Submit your test to check for the appropriate response.")])])]),e._v(" "),t("ul",[t("li",[e._v("For more information on comprehensive testing, the "),t("a",{attrs:{href:"https://learning.postman.com/docs/running-collections/intro-to-collection-runs/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Collection Runner on Postman"),t("OutboundLink")],1),e._v(" enables you to run the API requests in a collection in a specified sequence.")]),e._v(" "),t("li",[e._v("For more information on creating a collection for testing with Postman, go to "),t("a",{attrs:{href:"https://learning.postman.com/docs/designing-and-developing-your-api/testing-an-api/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Testing an API"),t("OutboundLink")],1),e._v(".")])])])}),[],!1,null,null,null);a.default=n.exports}}]);