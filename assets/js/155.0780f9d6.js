(window.webpackJsonp=window.webpackJsonp||[]).push([[155],{810:function(a,t,e){"use strict";e.r(t);var s=e(36),n=Object(s.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"manage-villanova-databases"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#manage-villanova-databases"}},[a._v("#")]),a._v(" Manage Villanova Databases")]),a._v(" "),e("p",[a._v("Villanova currently supports PostgreSQL, MySQL and Oracle database systems. With\nPostgreSQL and MySQL, Villanova automatically creates a Kubernetes deployment to host the DBMS.\nFor Oracle and others, Villanova supports connectivity with "),e("RouterLink",{attrs:{to:"/villanova09/tutorials/devops/external-db.html"}},[a._v("External Databases")]),a._v(".")],1),a._v(" "),e("p",[a._v("This document describes how Villanova manages databases and their connectivity.")]),a._v(" "),e("h2",{attrs:{id:"postgresql-and-mysql"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#postgresql-and-mysql"}},[a._v("#")]),a._v(" PostgreSQL and MySQL")]),a._v(" "),e("h4",{attrs:{id:"lightweight-low-config"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#lightweight-low-config"}},[a._v("#")]),a._v(" Lightweight & Low-Config")]),a._v(" "),e("p",[a._v("When deploying Villanova Custom Resources that require databases to a new\nnamespace, Villanova creates a Kubernetes deployment by default. It uses standard OpenShift compliant images.")]),a._v(" "),e("p",[a._v("A relatively low-configuration approach, Villanova creates and\ninitializes the databases transparently. Persistent data is stored on any\npersistent volume that meets the PersistentVolumeClaim requirements.")]),a._v(" "),e("p",[a._v("When an Villanova Custom Resource is redeployed, the persistent volumes\nremain intact. Since the subsequent data initialization is idempotent,\nthe supporting deployments will scale up and behave as expected.")]),a._v(" "),e("h4",{attrs:{id:"isolated-db"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#isolated-db"}},[a._v("#")]),a._v(" Isolated DB")]),a._v(" "),e("p",[a._v("Generally, Villanova services encapsulate the database they use,\nproviding mechanisms to import and export data without\nknowledge of the internal workings of the data store. For simpler applications, where database size remains manageable, Villanova isolates the DB without the need for deployment pipelines.")]),a._v(" "),e("p",[a._v("These database deployments are not clustered.\nIt is therefore recommended that redundancy and clustering, in the form of clustered storage, be utilized in this type of application.")]),a._v(" "),e("p",[a._v("These deployments specify a restartPolicy of "),e("code",[a._v("Always")]),a._v(". In the event of a\nnon-corrupting failure, the database pod should restart automatically. But this does not replace the features of a full database cluster.")]),a._v(" "),e("h4",{attrs:{id:"advanced-use-cases"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#advanced-use-cases"}},[a._v("#")]),a._v(" Advanced Use Cases")]),a._v(" "),e("p",[a._v("In more advanced cases, this approach may not scale. When there\nis a centralized admin team or strict organizational governance specifically for databases, this\napproach can result in a multitude of databases that may become difficult\nto manage.")]),a._v(" "),e("h2",{attrs:{id:"existing-external-databases"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#existing-external-databases"}},[a._v("#")]),a._v(" Existing External Databases")]),a._v(" "),e("p",[a._v("Villanova can be configured to use an existing\nDBMS provided by the customer. In such cases, lower level database\noperations such as tablespace creation, permissions and clustering must be carried out by the customer.")]),a._v(" "),e("p",[a._v("Then, Villanova creates and populates the tables, indices and foreign keys in the appropriate table structure for the specified DBMS. A dedicated custom resource definition in Kubernetes called "),e("code",[a._v("VillanovaDatabaseService")]),a._v(" is used to configure it.")]),a._v(" "),e("p",[a._v("The "),e("RouterLink",{attrs:{to:"/villanova09/docs/reference/database-cr.html"}},[e("code",[a._v("VillanovaDatabaseService")]),a._v(" custom resource")]),a._v(" is created in\nthe same namespace as the VillanovaApp and VillanovaPlugin that use them. It is usually created along with a Secret that carries admin credentials to the database.")],1),a._v(" "),e("p",[a._v("See "),e("RouterLink",{attrs:{to:"/villanova09/tutorials/devops/external-db.html"}},[a._v("Connecting to an External Database Tutorial")]),a._v(" for specific instructions.")],1),a._v(" "),e("h2",{attrs:{id:"how-it-works"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-it-works"}},[a._v("#")]),a._v(" How It Works")]),a._v(" "),e("h3",{attrs:{id:"database-custom-resource"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#database-custom-resource"}},[a._v("#")]),a._v(" Database Custom Resource")]),a._v(" "),e("p",[a._v("In order for the VillanovaApp and plugin deployer to choose the\ncorrect database service, the "),e("code",[a._v("VillanovaDatabaseService")]),a._v(" custom resource needs to be created\n"),e("strong",[a._v("BEFORE")]),a._v(" the app and plugins are created. There can be\nmultiple "),e("code",[a._v("VillanovaDatabaseServices")]),a._v(" in the namespace, but each needs to\npoint to the DBMS of different vendors, i.e. PostgreSQL, Oracle\nor MySQL.")]),a._v(" "),e("p",[a._v("Villanova currently does not enforce any validation, and if there\nare two "),e("code",[a._v("VillanovaDatabaseServices")]),a._v(" with the same DBMS vendor, it will\nsimply pick the first one and continue. Please ensure that only one\n"),e("code",[a._v("VillanovaDatabaseService")]),a._v(" exists for each vendor used.")]),a._v(" "),e("h4",{attrs:{id:"structure"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#structure"}},[a._v("#")]),a._v(" Structure")]),a._v(" "),e("p",[e("code",[a._v("VillanovaDatabaseService")]),a._v(" custom resource example:")]),a._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"EntandoDatabaseService"')]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"entando.org/v1"')]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# string, any K8s compliant name")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("namespace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# string, namespace this DB is created in")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("dbms")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# string, mysql, oracle, or postgresql ")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("host")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# string, IP address or hostname where the database service is hosted")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# integer, port on which the database service is hosted")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("databaseName")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# string, name of the database, only required for PostgreSQL and Oracle")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("secretName")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# name of the Secret in the same namespace carrying admin credentials to the database service")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("tablespace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# (Oracle only) tablespace to use for required schemas")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("jdbcParameters")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# map containing name-value pairs for any additional parameters required for the JDBC driver to connect to the database")]),a._v("\n")])])]),e("p",[e("code",[a._v("secretName")]),a._v(" example for the admin credentials:")]),a._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" Secret\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# string, any K8s compliant name")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("namespace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# string, namespace the DB is created in")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("stringData")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("username")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# string, name of an admin user who can create schemas and other users")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# string, password of the above user")]),a._v("\n")])])]),e("h4",{attrs:{id:"spec-dbms"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#spec-dbms"}},[a._v("#")]),a._v(" Spec.dbms")]),a._v(" "),e("p",[a._v("Any application or plugin that is created has to specify the\nappropriate DBMS vendor in their "),e("code",[a._v("spec.dbms")]),a._v(" property. If the\nVillanova Operator detects an "),e("code",[a._v("EntandoDatabaseService")]),a._v(" with a matching DBMS\nvendor, it creates the necessary schemas for that specific\ndatabase.")]),a._v(" "),e("p",[a._v("If the operator does not detect an\n"),e("code",[a._v("EntandoDatabaseService")]),a._v(" with a matching DBMS vendor, it falls back\nto its default behaviour--creating a matching deployment and\nspinning up a database service from the same namespace.")]),a._v(" "),e("p",[a._v("If the "),e("code",[a._v("spec.dbms")]),a._v(" property is not specified for an "),e("code",[a._v("EntandoApp")]),a._v(", the operator\ndefaults to PostgreSQL. If the "),e("code",[a._v("spec.dbms")]),a._v(" is not specified for\na plugin, the operator assumes that it\ndoes not require a database, bypassing any database\nand schema creation.")]),a._v(" "),e("p",[a._v("When the Villanova Operator processes the app or plugin with\nan appropriate "),e("code",[a._v("spec.dbms")]),a._v(" specification, it creates a schema/user pair\nfor each datasource required. A typical app deployment requires 3\ndatasources: portdb, servdb, and dedb. Plugins generally require 1\ndatasource: plugindb.")]),a._v(" "),e("h4",{attrs:{id:"db-schema-and-user-name"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#db-schema-and-user-name"}},[a._v("#")]),a._v(" DB Schema and User Name")]),a._v(" "),e("p",[a._v("The DB schema and user pair will have the same name. The name\nis derived from the plugin or app name, replacing\nall characters that are not ANSI-SQL compliant with an underscore.")]),a._v(" "),e("p",[a._v("The datasource name is then suffixed to the schema name. When naming\nyour app or plugin, keep in mind that some DBMS\ndo not support long schema names. Future versions of Villanova will allow\nyou to override the schema prefix for an app or plugin.")]),a._v(" "),e("h3",{attrs:{id:"credentials"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#credentials"}},[a._v("#")]),a._v(" Credentials")]),a._v(" "),e("p",[a._v('The Villanova Operator generates a Kubernetes Secret for each schema/user\ncombination it creates. The Secret name is the concatenation of\nthe app or plugin name, the datasource qualifier,\nplus the suffix "secret", connected by dashes.')]),a._v(" "),e("p",[a._v("E.g. VillanovaApp named "),e("code",[a._v("your-app")]),a._v(" and datasource "),e("code",[a._v("portdb")]),e("br"),a._v("\nKubernetes Secret → "),e("code",[a._v("your-app-portdb-secret")])]),a._v(" "),e("h4",{attrs:{id:"passwords-and-secrets"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#passwords-and-secrets"}},[a._v("#")]),a._v(" Passwords and Secrets")]),a._v(" "),e("p",[a._v("The Villanova Operator never overwrites or updates an existing database Secret. It generates a random string for the password, which is generally considered the safest\napproach. If you wish to change the password for the user, remember to update the password in the Kubernetes\nSecret. Such an operation can sometimes create an error, resulting in deployment failures.")]),a._v(" "),e("p",[a._v("The Villanova Operator’s schema creation logic is idempotent. If the generated schema/user combination in the\nassociated Kuberentes Secret already exists, there will be no side effects.\nBut if the login fails, it\nattempts to create the user. If the user already exists, with a\ndifferent password than the one in the Kubernetes Secret, all subsequent\ndeployment operations will fail.")]),a._v(" "),e("h2",{attrs:{id:"vendor-specific-notes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vendor-specific-notes"}},[a._v("#")]),a._v(" Vendor Specific Notes")]),a._v(" "),e("h3",{attrs:{id:"oracle"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#oracle"}},[a._v("#")]),a._v(" Oracle")]),a._v(" "),e("h4",{attrs:{id:"example"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#example"}},[a._v("#")]),a._v(" Example")]),a._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"EntandoDatabaseService"')]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"entando.org/v1"')]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" oracle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("service\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("dbms")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" oracle\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("host")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 10.0.0.13\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1521")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("databaseName")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" ORCLPDB1.localdomain\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("secretName")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" oracle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("secret\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("tablespace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" entando_ts\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("jdbcParameters")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("---")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" Secret\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" oracle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("secret\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("stringData")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("username")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" admin\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" admin123\n")])])]),e("h4",{attrs:{id:"resulting-connection-string"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resulting-connection-string"}},[a._v("#")]),a._v(" Resulting connection string:")]),a._v(" "),e("p",[a._v("jdbc:oracle:thin:@//10.0.0.13:1521/ORCLPDB1.localdomain")]),a._v(" "),e("h4",{attrs:{id:"notes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#notes"}},[a._v("#")]),a._v(" Notes")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("Oracle follows a few complicated rules when building the correct\nconnection string. For the sake of portability and\na lightweight image, the DB is limited to the thin driver.")])]),a._v(" "),e("li",[e("p",[a._v("The "),e("code",[a._v("databaseName")]),a._v(" could also be an Oracle service as opposed to the "),e("code",[a._v("SID")]),a._v(".\nCoordinate with your Oracle DB admin to determine exactly what value to\nuse. We strongly recommend testing your settings with code or\na tool that constructs a JDBC connection.")])]),a._v(" "),e("li",[e("p",[a._v("You can specify which tablespace Villanova should use to create the\nschemas by using the "),e("code",[a._v("spec.tablespace")]),a._v(" property.")])]),a._v(" "),e("li",[e("p",[a._v("When the operator prepares the schemas for your VillanovaApp or\nVillanova plugin, it creates a user for every datasource required.\nThat user will have their own schema\nwith the same name which is standard for Oracle. Permissions are set up to ensure that one user\ncannot access tables from another user’s schema.")])])]),a._v(" "),e("blockquote",[e("p",[a._v("Oracle limits schema names to 30 characters. If you intend to use Oracle,\nplease keep the name of your apps and plugins short. The suffixes added to the app or plugin name are usually shorter than 8 characters. Names of about\n20 characters should be safe to ensure the resulting schema\nname is unique.")])]),a._v(" "),e("h4",{attrs:{id:"ora-01704-string-literal-too-long"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ora-01704-string-literal-too-long"}},[a._v("#")]),a._v(" ORA-01704: string literal too long")]),a._v(" "),e("p",[a._v("Villanova requires extended datatypes to be activated in Oracle 12c and\nhigher.\n("),e("a",{attrs:{href:"https://oracle-base.com/articles/12c/extended-data-types-12cR1",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://oracle-base.com/articles/12c/extended-data-types-12cR1"),e("OutboundLink")],1),a._v(")")]),a._v(" "),e("h3",{attrs:{id:"mysql"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mysql"}},[a._v("#")]),a._v(" MySQL")]),a._v(" "),e("h4",{attrs:{id:"example-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#example-2"}},[a._v("#")]),a._v(" Example")]),a._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"EntandoDatabaseService"')]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"entando.org/v1"')]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" mysql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("service\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("dbms")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" mysql\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("host")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 10.0.0.13\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("databaseName")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("secretName")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" mysql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("secret\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("jdbcParameters")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n     "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("useSSL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"true"')]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("---")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" Secret\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" mysql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("secret\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("stringData")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("username")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" admin\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" admin123\n")])])]),e("h4",{attrs:{id:"resulting-connection-string-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resulting-connection-string-2"}},[a._v("#")]),a._v(" Resulting Connection String")]),a._v(" "),e("p",[a._v("jdbc:mysql://10.0.0.13:3306")]),a._v(" "),e("h4",{attrs:{id:"notes-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#notes-2"}},[a._v("#")]),a._v(" Notes")]),a._v(" "),e("ul",[e("li",[a._v("MySQL doesn’t distinguish between schemas and databases. For this reason, no\n"),e("code",[a._v("databaseName")]),a._v(" is required. The Villanova Operator will therefore create an\nentirely new database for each datasource your app or plugin requires. It also creates a user with the same name as\nthe database with permissions to ensure one user cannot access the\ndatabase of another user.")])]),a._v(" "),e("blockquote",[e("p",[a._v("MySQL limits database names\nto 63 characters. Keep this in mind when naming your\nVillanova Applications and plugins.")])]),a._v(" "),e("h3",{attrs:{id:"postgresql"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#postgresql"}},[a._v("#")]),a._v(" PostgreSQL")]),a._v(" "),e("h4",{attrs:{id:"example-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#example-3"}},[a._v("#")]),a._v(" Example")]),a._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"EntandoDatabaseService"')]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"entando.org/v1"')]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("postgresql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("service\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("dbms")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" postgresql\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("host")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 10.0.0.13\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("5432")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("databaseName")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" my_db\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("secretName")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" postgresql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("secret\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("jdbcParameters")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("---")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("apiVersion")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" v1\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" Secret\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" postgresql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("secret\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("stringData")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("username")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" admin\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" admin123\n")])])]),e("h4",{attrs:{id:"resulting-connection-string-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resulting-connection-string-3"}},[a._v("#")]),a._v(" Resulting Connection String")]),a._v(" "),e("p",[a._v("jdbc:postgresql://10.0.0.13:5432/my_db")]),a._v(" "),e("h4",{attrs:{id:"notes-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#notes-3"}},[a._v("#")]),a._v(" Notes")]),a._v(" "),e("ul",[e("li",[a._v("PostgreSQL behaves like Oracle when it comes to user and schema association. The current username is applied as a\ndefault schema/prefix to resolve tables. Villanova ensures\nthat two users don’t have access to the other’s schemas.")])]),a._v(" "),e("h2",{attrs:{id:"options"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#options"}},[a._v("#")]),a._v(" OPTIONS")]),a._v(" "),e("h3",{attrs:{id:"skipping-dbms-preparation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#skipping-dbms-preparation"}},[a._v("#")]),a._v(" Skipping DBMS Preparation")]),a._v(" "),e("p",[a._v("When an Villanova Application is deployed, an operator is responsible for the entire process, including DB creation and preparation.\nIf you already have a prepared DB (schemas, tables, etc.), you could skip the schema creation and DB preparation to speed up the deployment process.")]),a._v(" "),e("p",[a._v("To achieve this, specify the pertinent properties for the VillanovaApp component in the "),e("code",[a._v("entandoapp.yaml")]),a._v(" file.")]),a._v(" "),e("p",[a._v("For the "),e("code",[a._v("spec.dbms")]),a._v(" property, choose "),e("code",[a._v("none")]),a._v(". Then add the necessary DB connection parameters.\nHere is an example of the "),e("code",[a._v("entandoapp.yaml")]),a._v(":")]),a._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[a._v("   "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("kind")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"EntandoApp"')]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("metadata")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"YOUR-APP-NAME"')]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("dbms")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"none"')]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("replicas")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ingressHostName")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"YOUR-APP-NAME.192.168.1.100.nip.io"')]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("standardServerImage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"tomcat"')]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("environmentVariables")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" SPRING_DATASOURCE_USERNAME\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" admin\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" SPRING_DATASOURCE_PASSWORD\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" adminadmin\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" SPRING_DATASOURCE_URL\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:postgresql://192.168.1.82:5432/testdb?currentSchema=admin_qs_dedb"')]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" SPRING_JPA_DATABASE_PLATFORM\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" org.hibernate.dialect.PostgreSQLDialect\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" PORTDB_URL\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:postgresql://192.168.1.82:5432/testdb?currentSchema=admin_qs_portdb"')]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" PORTDB_USERNAME\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" admin\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" PORTDB_PASSWORD\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" adminadmin\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" PORTDB_CONNECTION_CHECKER\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" org.jboss.jca.adapters.jdbc.extensions.postgres.PostgreSQLValidConnectionChecker\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" PORTDB_EXCEPTION_SORTER\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" org.jboss.jca.adapters.jdbc.extensions.postgres.PostgreSQLExceptionSorter\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" SERVDB_URL\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:postgresql://192.168.1.82:5432/testdb?currentSchema=admin_qs_servdb"')]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" SERVDB_USERNAME\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" admin\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" SERVDB_PASSWORD\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" adminadmin\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" SERVDB_CONNECTION_CHECKER\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" org.jboss.jca.adapters.jdbc.extensions.postgres.PostgreSQLValidConnectionChecker\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" SERVDB_EXCEPTION_SORTER\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" org.jboss.jca.adapters.jdbc.extensions.postgres.PostgreSQLExceptionSorter\n")])])]),e("p",[e("strong",[a._v("Note")]),a._v(": This configuration is not meant to be used as a template for a production environment. The "),e("code",[a._v("environmentVariables")]),a._v(" section is equivalent to a standard "),e("code",[a._v("spec.env")]),a._v(" in Kubernetes.\nFor database credentials, use K8s Secrets to store them, using the syntax indicated here.")]),a._v(" "),e("h4",{attrs:{id:"how-it-works-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-it-works-2"}},[a._v("#")]),a._v(" How It Works")]),a._v(" "),e("ul",[e("li",[a._v("Using "),e("code",[a._v('spec.dbms: "none"')]),a._v(" directs the operator to skip the initial schema/user creation step.")]),a._v(" "),e("li",[a._v("Adding variables under the "),e("code",[a._v("spec.environmentVariables")]),a._v(" section will supply connection parameters used by the VillanovaApp.")]),a._v(" "),e("li",[a._v("Keep in mind that these parameters are applied to each of the containers in the VillanovaApp pod, overriding existing values.")])]),a._v(" "),e("h3",{attrs:{id:"liquibase-migration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#liquibase-migration"}},[a._v("#")]),a._v(" Liquibase Migration")]),a._v(" "),e("p",[a._v("Beginning with Villanova, the EntandoApp Engine modules include automatic Liquibase migrations to manage structural changes to databases running on MySQL or PostgreSQL.")]),a._v(" "),e("h4",{attrs:{id:"db-migration-modes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#db-migration-modes"}},[a._v("#")]),a._v(" DB Migration Modes")]),a._v(" "),e("p",[a._v("The parameter provided to the environment variable "),e("code",[a._v("DB_MIGRATION_STRATEGY")]),a._v(" determines how required updates are applied to components of an existing database. Three database migration modes are supported and govern upgrade behavior:")]),a._v(" "),e("ul",[e("li",[e("code",[a._v("auto")]),a._v(" (default setting): The application starts and databases are updated. Changes are applied to each component introduced in Villanova versions and later.")]),a._v(" "),e("li",[e("code",[a._v("disabled")]),a._v(": The application does not start. Database changes are detected but not implemented. The application indicates which components require updates.")]),a._v(" "),e("li",[e("code",[a._v("generate_sql")]),a._v(": The application does not start but generates the SQL scripts to upgrade databases manually.")])])])}),[],!1,null,null,null);t.default=n.exports}}]);